Refactor into modules that make more sense,
trying to take into account public API